<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="edu.whut.bear.gather.dao.UserDao">
    <!-- User getUserByUsernameAndPassword(@Param("username") String username, @Param("password") String password); -->
    <select id="getUserByUsernameAndPassword" resultType="User">
        select *
        from t_user
        where username = #{username}
          and password = #{password}
    </select>

    <!-- int updateLastLoginDateById(@Param("newDate") Date date, @Param("id") Integer userId); -->
    <update id="updateLastLoginDateById">
        update t_user
        set last_record_create_date = #{newDate}
        where id = #{id}
    </update>

    <!-- int updatePasswordById(@Param("newPassword") String newPassword, @Param("id") Integer id); -->
    <update id="updatePasswordById">
        update t_user
        set password = #{newPassword}
        where id = #{id}
    </update>

    <!-- List<User> getUserRecordNotCreated(@Param("classNumber") Integer classNumber, @Param("date") Date date); -->
    <select id="getUserRecordNotCreated" resultType="User">
        SELECT id, username, real_name, class_number, class_name
        FROM t_user
        WHERE class_number = #{classNumber}
          AND id NOT IN (SELECT user_id FROM t_record WHERE upload_date = #{date,jdbcType=DATE});
    </select>
</mapper>